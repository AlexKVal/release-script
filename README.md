# release-script

Release tool for npm and bower packages.

With this tool there is no need to commit transpiled `lib`, `build`
or `distr` files into git repo.

Because `Bower` keeps its files in the github repo,
this tools helps to deal with that too.

Just create new additional github repo for `Bower` version of your project.
This repo will contain only commits generated by this tool.

Say the name of your project is:
`original-project-name`.
Then name `bower` github repo as:
`original-project-name-bower`.

Add `bowerRepo` into your `package.json`:
```js
"bowerRepo": "git@github.com:<author>/original-project-name-bower.git",
```

Then add additional step into your building process,
which will create `bower` package files in the `amd` folder,
(basically it is just copying of `lib` files, README and LICENSE)
and that's all.

Now `release-script` will do all those steps (described next),
including `bower` publishing, for you automatically.


Initial idea is got from `React-Bootstrap` release tools `./tools/release`,
that have been written by [Matt Smith @mtscout6](https://github.com/mtscout6)

#### This script does following steps:

- ensures that git repo has no pending changes
- ensures that git repo last version is fetched
- checks linting and tests by running `npm run test` command
- does version bump, with `preid` if it is requested
- builds all by `npm run build` command
- generates changelog using `mt-changelog`
- adds and commits changed `CHANGELOG.md` and `package.json` files to git repo
- adds git tag with changelog message and new version
- pushes changes to github repo
- releases npm package by `npm publish` command
- if `bowerRepo` field is present in the `package.json`, then it releases bower package:
  - clones bower repo to local `tmpBowerRepo` temp folder. `git clone bowerRepo tmpBowerRepo`
    - By default it is named `tmp-bower-repo`
    - It is possible to set a custom `tmpBowerRepo` field in the `package.json`
  - then it cleans up all but `.git` files in the `tmpBowerRepo`
  - then copies all files from `bowerRoot` to `tmpBowerRepo`
    - (that has to be generated with `npm run build`)
    - `bowerRoot` also can be set to a custom value in the `package.json`
  - then by `git add -A .` adds all bower distr files to the temporary git repo
  - commits, tags and pushes the same as for the `npm` package.
  - then deletes the `tmpBowerRepo` folder

## Installation

```sh
> npm install -D release-script
```

Set `bowerRepo` into your `package.json` if you need `bower` releases too.
```js
"bowerRepo": "git@github.com:<org-author-name>/<name-of-project>-bower.git",
```

Then you can release like that:
```sh
> release patch
> release minor --preid alpha
```

You can use `--dry-run` option to check first what will be done and if it is OK.
```sh
> release major --dry-run --verbose
```
This option prevents `danger` steps from running. (`git push`, `npm publish` etc)

## License
`release-script` is licensed under the [MIT License](https://github.com/alexkval/release-script/blob/master/LICENSE).
